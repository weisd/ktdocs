## 策略分析

u 总体概要



净利润：统计期内交易产生的净利润，净利润=总盈利-总亏损，这是不可忽视的考察收益情况的第一指标，但单纯看净利润的数额不能客观评判整个绩效状况。



总盈利（毛利）：每笔盈利的交易实现的盈利总和，若把投资看做是商业活动，这个数额就是总收入。



总亏损（毛损）：每笔亏损的交易实现的亏损总和，若把投资看做是商业活动，这个数额就是总支出，设法减少亏损就能增加净利润。把交易亏损看成是做生意的成本支出，也更能坦然接受亏损交易，想想，开个公司每天都有支出，好比每天都有亏损交易，输得起的交易者才能成为赢家。



盈利因子(毛利/毛损) ：总盈利/总亏损，也称为盈利比。它表示每亏损（支出）1元能获取多少元的盈利（收入）。这个比率说明投资效率，当然是越大越好。



收益率%：净利润/期初资产×100%，假设在统计期没有追加或减少资金。



年化收益率%：几何平均的年复合收益率（年复利、CAR、CAGR）。



最大资产回撤：逐根K线计算资产极高值出现后到极低值的最大回撤（缩水）金额，若资产值创新高，则重新计算，从该点再计算下一次最大回撤，该值就是其中最大值的那次回撤。可以从详细资产曲线的阶段高峰到阶段低谷查看该值变化。通过这个统计值，可以检视自己在这样的交易数量下能忍受多大的回撤金额。它与最大资产回撤幅度是衡量风险的重要指标，固定交易量看这个指标，随资产变动调整调整交易量则看最大资产回撤幅度。



净利润/最大资产回撤：又称恢复因子，在统计期内获得利润与承受风险的比率。这是考察风险与回报关系的重要指标。



最大资产回撤幅度：以百分比计量回撤幅度而不是回撤金额，计算方法与最大资产回撤相似。强平、爆仓风险来自于这个回撤幅度。通过这个统计值，可以检视自己在心理、资金上能忍受多大的资产回撤幅度。

这个幅度可认为是对风险最重要的衡量工具，通过考察长期的、跨越不同市场状况的资产回撤情况，可以对交易中发生的所有负面结果及其相关影响有个充分的了解。

年化收益率/最大资产回撤幅度：又称MAR比率，这是最常用的风报比指标。考察让资产平均每年增值的幅度与需承受的最大资产回撤幅度的关系。



交易次数：交易总次（笔）数，分批开仓后一次平仓，一次开仓后分批平仓，都会拆成一一对应的交易量相同的多次交易。这个指标可以评估交易的频率，由于每次交易是要付出交易成本的，这个数据也和佣金、滑价等交易费用支出相关，过于频繁的交易，其成本可能吃掉可以取得的利润。用分批开平仓的技巧可以减小风险，也可用于调整胜率、盈亏比。

盈利交易次数：盈利交易是指开平仓差价产生的毛利减去开平仓交易成本（包括佣金、滑价、息差等）依然有利润的交易。



亏损交易次数：亏损交易是指平仓后产生亏损的交易。盈利交易次数与亏损交易次数之和可能小于总交易次数，其差值为盈利为0的打平交易次数。



胜率%：胜率% = 盈利交易次数/交易次数*100%，盈利交易次数所占的百分比，也称为正确率或赢亏率。胜率低于50%未必是亏损系统，只要每次交易的平均盈利比平均亏损足够大。一般未经过特别过滤的趋势跟随型或突破型策略，其长期的胜率低于40%。而均值回归型策略其胜率容易达到50%以上，但如果不控制好每次交易的亏损，很高的胜率也未必是盈利的系统。设置止赢位、止损位对改变胜率和盈亏比有极大影响。通常来说，投资者尤其是新手偏好高胜率的交易，胜率太低会影响心态，导致无法长期坚持执行，所以，策略组合最好能牺牲些盈亏比换来胜率大于50%，好比薄利多销而不求暴利，在实战中心理上也比较容易接受。



平均盈亏：每次交易的盈亏额的平均值，也称为预期盈利、期望收益。对于每次交易固定数量或金额的系统（统计期内价格波幅不大的可固定数量，反之应固定金额），看预期收益比较有意义。如果策略测试时佣金和滑价设置为0，那么这个值应大于这些实际交易时可能产生的交易成本才是可盈利的策略。

平均盈亏=净利润/交易次数=每笔交易的期望收益=平均盈利×胜率-平均亏损×（1-胜率）



平均盈利：盈利的交易每次平仓实现盈利额的平均值，平均盈利=总盈利（毛利）/盈利交易次数。

平均亏损：亏损的交易每次平仓实现亏损额的平均值，平均盈利=总亏损（毛损）/亏损交易次数。

盈亏比：平均盈利/平均亏损，趋势交易追求高盈亏比，用多次小的试错成本换来一次大的盈利。不同风格的交易策略，或偏好高胜率，或偏好高盈亏比，长线趋势型系统，其盈亏比高，短线交易系统，盈亏比相对较低。

最大单次盈利：盈利交易中最大一次的盈利，若最大单次盈利与平均盈利差距过大，则应视为偶然事件。

最大单次亏损：亏损交易中最大一次的亏损，若最大单次亏损与平均亏损差距过大，应检查系统的风险控制能力，可以考虑设置止损位，以防御突发状况造成的重大亏损。

最大连续盈利次数：盈利有时有集中的现象，策略适应此阶段的走势形态。也许可以考虑在连续盈利接近最大连盈次数时，开始减轻每次交易投入的资金。

最大连续亏损次数：亏损有时有集中的现象，策略不适应此阶段的波动，心理上能否承受如此多次的试错？也许可以考虑在连续亏损最大次数时，逐步增大资金投入。 

平均持仓周期：持仓周期/交易次数，考察策略偏长线或是短线

平均盈利周期：盈利交易持仓周期/盈利交易次数，考察盈利交易是否需要耐心持有

平均亏损周期：亏损交易持仓周期/亏损交易次数，考察亏损交易是否及时平仓



u 风险分析（过度冒险是自寻死路，但是不敢冒一定的风险就会失去很多机会，评估风险并以此改进风险管理技术有助于树立信心和耐心，实现预期目标）



去离群总盈利：去除离群盈利交易产生的总盈利，离群盈利交易是指单次盈利在n倍标准。              



去离群总亏损：去除离群亏损交易产生的总亏损，离群亏损交易是指单次亏损在n倍标准差之外的亏损，如果去离群总亏损与总亏损差距过大，说明大部分亏损来自于突发的重大亏损，则策略需要增强防御这类情况的能力。              



期末持仓盈亏：统计期末有持仓时的浮动盈亏，若没有未平仓头寸，显示N/A             



持有收益：统计期初不用资金杠杆全额开仓，到期末实现的盈利或亏损，其收益率即等于期末价格变动的幅度。比如10万初始资金，商品期末价格上涨了200%，则多头持有收益为20万，空头持有收益为-20万，不必考虑是否支持保证金交易、资金杠杆是多少。不能简单地以净利润与该收益作比较判定策略好坏，因为还需要比较资产最大回撤和收益标准差这类风险度量，如果在风险报酬比率上优于简单开仓持有，则是好的策略。                  

佣金合计：包括经纪商手续费、交易所手续费、股票托管费等交易费用                 

滑价合计：历史回测测试时假设的滑价，或者实际交易中滑价导致的交易成本。                  

最大单次盈利/总盈利：若该值较高，即最大单次盈利在总盈利中的比重过大，则说明系统实际盈利能力和稳定性不高。      

最大单次亏损/总亏损：若该值较高，这次最大亏损是否是这个策略的“黑天鹅”。     

净利润/最大单次亏损：该值越高越好。               

回归年化收益率：对资产曲线按月（年、周）计算线性回归后的年复合收益率，对统计的起止日期相对不敏感。            

月化收益率：月复合收益率（月复利）。               

月平均收益（30天/月）：净利润/统计期间月数。  

月收益标准差：每个月净利润的标准差。              

月收益率标准差：统计每月资产收益率的标准差，标准差越小表示资产曲线越平滑。           

最大资产回撤：逐根K线计算资产极高值出现后到极低值的最大回撤（缩水）金额，若资产值创新高，则重新计算，从该点再计算下一次最大回撤，该值就是其中最大值的那次回撤。可以从详细资产曲线的阶段高峰到阶段低谷查看该值变化。在这样的交易数量下能忍受多大的回撤金额。              

最大资产回撤发生期：从资产高峰到低谷的起止日期。        

最大资产回撤幅度：以百分比计量回撤幅度而不是回撤金额，其余与最大资产回撤相同。强平、爆仓风险来自于这个回撤幅度。心理、资金上能忍受多大的资产回撤幅度。

这个幅度可认为是对风险最重要的衡量工具，通过考察长期的、跨越不同市场状况的资产回撤情况，可以对交易中发生的所有负面结果及其相关影响有个充分的了解。

最大资产回撤幅度发生期：最大资产回撤幅度发生的起止日期。

最长资产回撤持续时间（天）：从资产极高值到创新高所经过的最长时间，衡量的是恢复速度，即一段损失期后需多长时间资产额才能重新站上新的高点。这个期间未必是最大资产回撤或回撤幅度发生的期间。

通常投资市场都是快跌慢涨，包括资产曲线。假如初始资本是100万元，回撤50%，那就只剩50万元，要恢复到100万元，需要获利100%，显然这更大可能是需要更长的时间，难度也更大。所以，首要任务是保存资本，再图盈利。

对于那些需要从业绩增量中获得报酬的基金管理者，当资产回撤达到一定程度，如果想尽快收回损失，相应的恢复过程就需要及时增加资本投入，伴随而来的财务压力可能使基金管理者变得不耐烦并想努力尽快捞回损失而采取激进措施，但很可能会发现自己掉进了一个更深的洞，进而威胁整个交易计划的生存。所以，把一定的资产回撤作为降低风险的基础是风险管理计划的重要组成部分。例如，在交易计划之初就确立资产回撤达到10%时就将仓位降低50%，首先，这将大大有助于减少资产进一步回撤的程度，其次，从长期来看会更有信心承担未来可能发生的更大的风险。

最大浮动亏损：有持仓时的最大浮动亏损金额，浮动亏损可能对投资者心理造成较大冲击，在期货这种运用资金杠杆的情况下，会导致可用金减少，直接影响保证金水平，甚至带来穿仓风险，被强行平仓甚至直接爆仓，这个指标可以帮助头寸管理和设定机动的最大亏损止损位。             

最大浮动亏损幅度：有持仓时的最大浮动亏损幅度，以百分比考察浮动亏损，统计期间价格幅度变化很大时，用百分比有可比性。对于短期或固定金额开仓，数额指标比较直观，但对长期的或持仓量变化大的，应该检视幅度指标。          

最大平仓交易回撤：逐笔计算平仓交易时的资产的极高值出现后的最大亏损金额，若平仓交易时的资产值创新高，则重新计算，从该点再计算下一次最大回撤，该值就是其中最大值的那次回撤。可以从平仓交易资产曲线的阶段高峰到阶段低谷查看该值变化。          

最大平仓交易回撤发生期：平仓交易时从资产高峰到低谷的起止日期。   

最大平仓交易回撤幅度：以百分比计量回撤幅度而不是回撤金额，其余与最大平仓交易回撤相同。      

最大平仓交易回撤幅度发生期：以百分比计量回撤幅度而不是回撤金额，其余与最大平仓交易回撤相同。

净利润/最大资产回撤：以百分比计量回撤幅度而不是回撤金额，其余与最大平仓交易回撤相同。       

净利润/最大平仓交易回撤：以百分比计量回撤幅度而不是回撤金额，其余与最大平仓交易回撤相同。   

年化收益率/最大资产回撤幅度：以百分比计量回撤幅度而不是回撤金额，其余与最大平仓交易回撤相同。

有效年化收益率/最大资产回撤幅度：大于2为好。

年化收益率/25%的最大资产回撤幅度的平均值：分母以最大的25%的资产回撤幅度的平均值作为风险。

ULCER指数：用于计算Ulcer绩效指数，以资产回撤的平均化作为风险度量

Ulcer =sqrt((R1^2+ R2^2+......+ Rn^2)/n)

R1、R2...... Rn为第1、第2......第n个资产回撤幅度。               

R平方：资产曲线与基准指数的相关系数的平方*100，反映基准指数（大盘）的波动对收益表现的影响，该值用于度量策略的系统风险，或者说是系统风险在总风险中所占的比重。例如指数ETF对标的指数的R平方接近于100。                    



夏普指数：经风险调整后的绩效指标，用于衡量投资的有效回报。

夏普指数=（月化收益率-无风险月利率）/月收益率标准差    SR=(MR-RFR)/SD

无风险利率（RiskFreeReturn  RFR）一般为银行定存利率或短期国债的月收益率，在【选项】中设置。

时间跨度很长的可以用年化收益率和无风险年利率计算。夏普指数大于1为好，大于2很好，若为负值，表示承受风险但回报率反而不如存银行。 

Ulcer绩效指数：以夏普指数相似，但以资产回撤作为风险衡量

UPI=（年化收益率-无风险年利率）/ Ulcer

以Ulcer指数代替夏普计算公式中的分母。          

稳健风报比：回归年化收益率/长度调整平均最大回撤

 长度调整平均最大回撤＝最大5次回撤幅度的平均值×这5次回撤期的平均天数/365，从回撤幅度和持续时间这两个角度来度量风险。



飞狐评分：该分值综合衡量盈利能力、资金占用率（平均仓位）、最大风险和长期稳定性。同样的年化收益率，若仓位越大，表示投入资金越多，分数越低；若回撤越大，表示爆仓风险越大，则分数越低；标准差越小，统计时间越长，稳定性越好，则分数越高。

分值 =年化收益率/平均仓位×(1 + 最大资产回撤比例) ×（1-月收益标准差*3）×交易月数^（1/3）

这个算法对开始运行不久（1年之内）取得较好收益的策略评分偏高。

例如,年化收益率 30%,平均仓位30%,最大资产回撤比例 -15%，月收益标准差3%，交易期长达125个月的策略，其分数为:

(30 / 0.3)*(1 - 0.15)*（1-0.03*3）* 125^（1/3） = 100 * 0.85 * 0.91*5 = 386.75

对于亏损系统，不计交易月数，为了让回撤比例越大，稳定性越差，负值越大，算式为

分值 =年化收益率/平均仓位×(1 + 最大资产回撤比例的绝对值) ×（1+月收益标准差*3）

例如,年化收益率 -30%,其余数据与上述相同，则分数为:

(-30 / 0.3)*(1 + 0.15) *（1+0.03*3） = -100 * 1.15 *1.09= -125.35



u 时间仓位分析



总交易时间：有足够历史数据可让策略产生交易信号的期间，不一定等同测试期间。                

持仓时间（天）：有持仓的天数总计。           

持仓时间%：有持仓的天数总计。                

最大空仓时间（天）：这个空仓时间长可能意味着必须有足够耐心等待下一次交易。        

总交易月数：总交易期间换算成月数量。                

盈利月数：交易期资产增值的月数量。                 

资产增值天数：统计当天收盘比前一天资产增值的天数。              

资产减值天数：统计当天收盘比前一天资产减值的天数。              

获利日占比：资产增值天数/总交易时间*100%。               

最大浮盈日期：最大浮盈的具体日期。             

最大浮亏日期：最大浮亏的具体日期。                            

平均持仓周期：持仓周期/交易次数，考察策略偏长线或是短线。              

平均盈利周期：盈利交易持仓周期/盈利交易次数，考察盈利交易是否需要耐心持有。

平均亏损周期：亏损交易持仓周期/亏损交易次数，考察亏损交易是否及时平仓。

最大持仓数量：统计历史上曾经的最大的持仓合约数。              

最大占用资金：统计历史上最大投入的资金额，开仓到最大仓位时投入的资金。              

最小账户资金：最大资产回撤+占用的保证金。              

平均仓位：对每根K线取样计算持仓占用的资金/资产的百分比平均值，仓位意味着风险敞口，该百分比越高，表示资产暴露给市场波动风险的程度越高，也表示在市场上投入资金量越大，机会成本越大，没有更多的资金投入其他地方。                  



u 资金曲线



![](/assets/1710031.png)



资产曲线是每天对应的资产连线，它有三条线，红线表示表现资产的潜在高点，绿线表示资产的潜在低点，黑线是平仓后才把平仓盈亏计入资产（余额）的曲线。显然，多头持仓的资产高点以持仓期间每日的最高价计算，资产低点以最低价计算，因尚未平仓，浮动盈亏不计入资产余额，所以持仓期间黑线是水平线，空头持仓则反之。如果某段时期没有持仓，则三条线都是数值一样的水平连线。



附图占用保证金曲线，代表对应当时占用了多少保证金。



双击鼠标出现十字光标可查看各点数值。



u 资产及水下（回撤）曲线图



![](/assets/1710032.png)



资产曲线是每天对应的资产连线，它有三条线，红线表示表现资产的潜在高点，绿线表示资产的潜在低点，黑线是平仓后才把平仓盈亏计入资产（余额）的曲线。显然，多头持仓的资产高点以持仓期间每日的最高价计算，资产低点以最低价计算，因尚未平仓，浮动盈亏不计入资产余额，所以持仓期间黑线是水平线，空头持仓则反之。如果某段时期没有持仓，则三条线都是数值一样的水平连线。



资产回撤曲线是资产从潜在高点回撤到潜在低点的金额，其最大值即【总体概要表】中的“最大资产回撤”，固定数量交易用该曲线评估风险。



资产回撤幅度曲线是资产从潜在高点回撤到潜在低点的幅度，其最大值即【总体概要表】中的“最大资产回撤幅度”，随资金变动调整交易数量的用该曲线评估风险。



双击鼠标出现十字光标可查看各点数值。



u 资产升水及回撤曲线图



![](/assets/1710033.png)



资产升水曲线表示表现资产的潜在高点的数值连线。



资产回撤曲线是资产从潜在高点回撤到潜在低点的金额，其最大值即【总体概要表】中的“最大资产回撤”，固定数量交易用该曲线评估风险。



u 资产升水及回撤幅度曲线图



![](/assets/1710034.png)



资产升水曲线表示表现资产的潜在高点的幅度连线。



资产回撤幅度曲线是资产从潜在高点回撤到潜在低点的幅度，其最大值即【总体概要表】中的“最大资产回撤幅度”，随资金变动调整交易数量的用该曲线评估风险。



双击鼠标出现十字光标可查看各点数值。